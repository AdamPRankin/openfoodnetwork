%div.checkout-substep
  -# YOUR DETAILS
  %div.checkout-title
    = t("split_checkout.step1.your_details.title")

  %div.checkout-input
    = fields_for :bill_address, @order.bill_address do |bill_address|
      = bill_address.label :firstname, t("split_checkout.step1.your_details.first_name.label")
      = bill_address.text_field :firstname, { placeholder: t("split_checkout.step1.your_details.first_name.placeholder") }
    
  %div.checkout-input
    = fields_for :bill_address, @order.bill_address do |bill_address|
      = bill_address.label :lastname, t("split_checkout.step1.your_details.last_name.label")
      = bill_address.text_field :lastname, { placeholder: t("split_checkout.step1.your_details.last_name.placeholder") }

  %div.checkout-input
    = f.label :email, t("split_checkout.step1.your_details.email.label")
    = f.text_field :email, { placeholder: t("split_checkout.step1.your_details.email.placeholder") }
  
  %div.checkout-input
    = fields_for :bill_address, @order.bill_address do |bill_address|
      = bill_address.label :phone, t("split_checkout.step1.your_details.phone.label")
      = bill_address.text_field :phone, { placeholder: t("split_checkout.step1.your_details.phone.placeholder") }

%div.checkout-substep
  -# BILLING ADDRESS
  %div.checkout-title
    = t("split_checkout.step1.billing_address.title")

  %div.checkout-input
    = fields_for :bill_address, @order.bill_address do |bill_address|
      = bill_address.label :address1, t("split_checkout.step1.billing_address.address1.label")
      = bill_address.text_field :address1, { placeholder: t("split_checkout.step1.billing_address.address1.placeholder") }

  %div.checkout-input
    = fields_for :bill_address, @order.bill_address do |bill_address|
      = f.label :address2, t("split_checkout.step1.billing_address.address2.label")
      = f.text_field :address2, { placeholder: t("split_checkout.step1.billing_address.address2.placeholder") }

  %div.checkout-input
    = fields_for :bill_address, @order.bill_address do |bill_address|
      = bill_address.label :city, t("split_checkout.step1.billing_address.city.label")
      = bill_address.text_field :city, { placeholder: t("split_checkout.step1.billing_address.city.placeholder") }

  %div.checkout-input
    = fields_for :bill_address, @order.bill_address do |bill_address|
      = bill_address.label :state_id, t("split_checkout.step1.billing_address.state_id.label")
      -# todo: get state // values: s.id as s.name for s in countriesById[order.bill_address.country_id].states // defaultvalue: {}
      = bill_address.select :state_id, []       

  %div.checkout-input
    = fields_for :bill_address, @order.bill_address do |bill_address|
      = bill_address.label :zipcode, t("split_checkout.step1.billing_address.zipcode.label")
      = bill_address.text_field :zipcode, { placeholder: t("split_checkout.step1.billing_address.zipcode.placeholder") }

  %div.checkout-input
    = fields_for :bill_address, @order.bill_address do |bill_address|
      = bill_address.label :country_id, t("split_checkout.step1.billing_address.country_id.label")
      -# todo: get countries // values: c.id as c.name for c in countries // defaultvalue: order.bill_address.country_id = order.bill_address.country_id || #{DefaultCountry.id}
      = bill_address.select :country_id, [] 

  - if spree_current_user||true
    %div.checkout-input
      = f.check_box :checkout_default_bill_address
      = f.label :checkout_default_bill_address, t(:checkout_default_bill_address)

  %div.checkout-substep  
    -# DELIVERY ADDRESS
    %div.checkout-title
      = t("split_checkout.step1.delivery_address.title")

    = for shipping_method in @shipping_methods
      %div.checkout-input
        = fields_for shipping_method do |shipping_method_form|
          = shipping_method_form.check_box :name, {id: "shipping_method_" + shipping_method.id.to_s }
          = shipping_method_form.label :name, shipping_method.name, {for: "shipping_method_" + shipping_method.id.to_s }
          %em.light
            -# todo: display method price | localizeCurrency // How to retrive shipping method price?
              = if shipping_method.price && shipping_method.price != 0
                = method.price
              - else
                = t(:checkout_method_free)


    - if true # todo: Checkout.requireShipAddress()  //   requireShipAddress: -> @shippingMethod()?.require_ship_address
      %div.checkout-input
        = f.check_box "Checkout.ship_address_same_as_billing", { id: "Checkout.ship_address_same_as_billing" } # "ng-model": "Checkout.ship_address_same_as_billing"}s
        = f.label "Checkout.ship_address_same_as_billing", t(:checkout_address_same), { for: "Checkout.ship_address_same_as_billing" }
        
    - if spree_current_user || true # todo: && Checkout.requireShipAddress()  //   requireShipAddress: -> @shippingMethod()?.require_ship_address
      %div.checkout-input
        = f.check_box "Checkout.default_ship_address", { id: "Checkout.default_ship_address" }
        = f.label "Checkout.default_ship_address", t(:checkout_default_ship_address), { for: "Checkout.default_ship_address" }

    - if true # todo: Checkout.shippingMethod().description
      .div.checkout-input
        #distributor_address.panel
          %span{}{{ Checkout.shippingMethod().description }}
          %br/
          %br/
          - if @order.order_cycle.pickup_time_for(@order.distributor)
            = t :checkout_ready_for
          = @order.order_cycle.pickup_time_for(@order.distributor)

    .div.checkout-input
      = f.label :special_instructions, t(:checkout_instructions)
      = f.text_area :special_instructions, size: "60x4"

  %div.checkout-submit
    = f.submit t("split_checkout.step1.submit"), class: "button primary", disabled: @terms_and_conditions_accepted == false || @platform_tos_accepted == false
    %a.button.cancel{href: main_app.cart_path}
      = t("split_checkout.step1.cancel")
